<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modaura Luxe | New York</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@1,600&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Montserrat', sans-serif; background-color: #fdfaf7; }
        .font-serif { font-family: 'Cormorant Garamond', serif; }
        .admin-only { display: none; }
        .glass { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(12px); border-bottom: 1px solid rgba(0,0,0,0.05); }
    </style>
</head>
<body>

    <nav class="glass sticky top-0 z-50 p-5 px-8 flex justify-between items-center">
        <h1 class="text-2xl font-serif italic tracking-widest text-[#222]">Modaura</h1>
        <button id="adminBtn" onclick="toggleAdmin()" class="text-[9px] tracking-[3px] text-gray-400 uppercase">Partner Access</button>
        <button id="logoutBtn" onclick="logout()" class="hidden text-xs text-red-400 underline font-bold">Close Studio</button>
    </nav>

    <div id="adminPanel" class="admin-only max-w-2xl mx-auto mt-8 p-8 bg-white rounded-[30px] shadow-2xl border border-pink-50">
        <h2 class="text-xs tracking-widest text-pink-400 uppercase mb-8 text-center font-bold">Add Affiliate Listing</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <input type="text" id="dressName" placeholder="Dress Title" class="w-full p-4 bg-gray-50 rounded-2xl outline-none focus:ring-1 focus:ring-pink-200">
            <input type="number" id="dressPrice" placeholder="Price ($)" class="w-full p-4 bg-gray-50 rounded-2xl outline-none focus:ring-1 focus:ring-pink-200">
            <input type="text" id="dressImage" placeholder="Image URL (Link)" class="w-full p-4 bg-gray-50 rounded-2xl outline-none focus:ring-1 focus:ring-pink-200 md:col-span-2">
            <input type="text" id="amazonLink" placeholder="Amazon Affiliate Link (https://...)" class="w-full p-4 bg-pink-50 rounded-2xl outline-none focus:ring-1 focus:ring-pink-300 md:col-span-2 text-pink-700 font-medium">
            <textarea id="dressDesc" placeholder="Dress Description (Size, Material, Event type...)" class="w-full p-4 bg-gray-50 rounded-2xl outline-none focus:ring-1 focus:ring-pink-200 md:col-span-2 h-32"></textarea>
            <button onclick="saveDress()" class="md:col-span-2 bg-black text-white p-5 rounded-2xl font-bold uppercase text-[11px] tracking-widest hover:bg-pink-600 transition shadow-lg">Publish Listing</button>
        </div>
    </div>

    <header class="text-center py-20 px-6">
        <span class="text-[10px] tracking-[5px] text-pink-400 uppercase mb-4 block">Affiliate Boutique</span>
        <h2 class="text-6xl font-serif italic text-[#222]">Curated for You.</h2>
        <p class="text-gray-400 text-[10px] mt-6 tracking-[4px] uppercase font-light">Elegance meets New York City</p>
    </header>

    <main class="max-w-7xl mx-auto px-8 pb-32">
        <div id="productGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-12">
            <p class="col-span-full text-center text-gray-300 text-[10px] tracking-[5px] py-20 italic">UPDATING GALLERY...</p>
        </div>
    </main>

    <script>
        const PASS = "rafay1259";
        let isAdmin = false;

        function toggleAdmin() {
            const entry = prompt("Secret Key:");
            if (entry === PASS) {
                isAdmin = true;
                document.getElementById('adminPanel').style.display = 'block';
                document.getElementById('adminBtn').classList.add('hidden');
                document.getElementById('logoutBtn').classList.remove('hidden');
            } else { alert("Incorrect key."); }
        }

        function logout() {
            isAdmin = false;
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('adminBtn').classList.remove('hidden');
            document.getElementById('logoutBtn').classList.add('hidden');
        }

        async function saveDress() {
            const name = document.getElementById('dressName').value;
            const price = document.getElementById('dressPrice').value;
            const image = document.getElementById('dressImage').value;
            const link = document.getElementById('amazonLink').value;
            const desc = document.getElementById('dressDesc').value;

            if(!name || !price || !image || !link) return alert("Please fill Title, Price, Image and Amazon Link!");

            const res = await fetch('/api/save', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ name, price, image, link, desc, id: Date.now() })
            });

            if(res.ok) {
                alert("Affiliate Dress Added!");
                location.reload();
            }
        }

        async function loadDresses() {
            const res = await fetch('/api/get-dresses');
            const data = await res.json();
            const grid = document.getElementById('productGrid');
            
            if(!data || data.length === 0) {
                grid.innerHTML = '<p class="col-span-full text-center text-gray-300 py-20 text-[10px] tracking-[5px]">NEW DROPS COMING SOON</p>';
                return;
            }

            grid.innerHTML = data.map(item => `
                <div class="group bg-white rounded-[40px] p-4 shadow-sm hover:shadow-2xl transition-all duration-500">
                    <div class="relative overflow-hidden rounded-[30px] aspect-[3/4]">
                        <img src="${item.image}" class="w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110">
                    </div>
                    <div class="mt-6 px-2 pb-2">
                        <div class="flex justify-between items-center mb-2">
                            <h3 class="text-[11px] font-bold text-gray-800 uppercase tracking-widest truncate w-2/3">${item.name}</h3>
                            <p class="text-sm font-serif italic text-pink-500">$${parseFloat(item.price).toFixed(2)}</p>
                        </div>
                        <p class="text-[10px] text-gray-400 leading-relaxed mb-6 line-clamp-2">${item.desc || 'Perfect for your next high-profile event.'}</p>
                        <a href="${item.link}" target="_blank" class="block w-full bg-black text-white text-center py-4 rounded-2xl text-[10px] uppercase tracking-[3px] font-bold hover:bg-pink-600 transition-colors shadow-md">Buy on Amazon</a>
                    </div>
                </div>
            `).reverse().join('');
        }
        loadDresses();
    </script>
</body>
</html>
